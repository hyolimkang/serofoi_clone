<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="serofoi">
<title>Use cases ‚Ä¢ serofoi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use cases">
<meta property="og:description" content="serofoi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">serofoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/serofoi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simulated_data.html">Simulated data</a>
    <a class="dropdown-item" href="../articles/use_cases.html">Use cases</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use cases</h1>
            
      
      
      <div class="d-none name"><code>use_cases.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="epidemiological-scenarios-for-the-serofoi-models">Epidemiological scenarios for the <em>serofoi</em> models<a class="anchor" aria-label="anchor" href="#epidemiological-scenarios-for-the-serofoi-models"></a>
</h2>
<p><strong>serofoi</strong> is an R package that allows estimations of
the Force-of-Infection from a population based serosurvey data.</p>
<div class="section level3">
<h3 id="sero-survey-data">
<strong>Sero-survey data</strong><a class="anchor" aria-label="anchor" href="#sero-survey-data"></a>
</h3>
<p>Surveys had to meet all of the following <u>inclusion
criteria</u>:</p>
<ol style="list-style-type: decimal">
<li><p>Be population-based (not hospital based)</p></li>
<li><p>Specify individuals‚Äô age or age group</p></li>
<li><p>Indicate diagnostic test(s) used. The current version of serofoi
only applies to <em>IgG</em> antibodies)</p></li>
<li><p>Identify the location and date (year) of sample
collection</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="model-assumptions">Model assumptions<a class="anchor" aria-label="anchor" href="#model-assumptions"></a>
</h3>
<p>Current version of <strong>serofoi</strong> includes the following
assumptions on the underlying biological process:</p>
<ul>
<li><p>The Force-of-infection (FoI) is estimated using a catalytic
model</p></li>
<li><p>There is no sero-reversion (from positive to negative). It means
IgG antibodies are life-long duration with no waning immunity. This may
not be the case for several pathogens. This feature is planned for
future versions of <em>serofoi</em><strong>.</strong></p></li>
<li><p>There is no age-dependency. This may not be the case for several
pathogens. This feature is planned for future versions of
<em>serofoi</em><strong>.</strong></p></li>
<li><p>There is no impact from migration processes in the sampled
population</p></li>
<li><p>There are no differences in the mortality rate of infected versus
susceptible individuals</p></li>
</ul>
<div class="alert alert-primary">
<p>NOTE: Running the <em>serofoi</em> models for the first time on your
local computer make take a few minutes while the <em>rstan</em> code is
compiled locally. Afterwards, no further local compilation is
needed.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="constant-vs-time-varying-foi-models">
<strong>Constant vs Time-varying</strong> FoI models<a class="anchor" aria-label="anchor" href="#constant-vs-time-varying-foi-models"></a>
</h2>
<div class="section level3">
<h3 id="constant-force-of-infection-endemic-model">Constant Force-of-Infection (endemic model)<a class="anchor" aria-label="anchor" href="#constant-force-of-infection-endemic-model"></a>
</h3>
<p>For <em>constant</em> <em>endemic model</em>, the rate of infection
acquisition‚Äïrate of seroconversion‚Äïis constant over time, and infection
(sero)prevalence will increase monotonically with age as cumulative
exposure increases.</p>
<p>Denoting <span class="math inline">\(n(a,t)\)</span> the number of
seropositive individuals of age <span class="math inline">\(a\)</span>
at time <span class="math inline">\(t\)</span> , <span class="math inline">\(N\)</span> the serosurvey sample size, and <span class="math inline">\(P(a,t)\)</span> the underlying seroprevalence at
age <span class="math inline">\(a\)</span> at time <span class="math inline">\(t\)</span>, we assumed that the number of
seropositive subjects follows a Binomial distribution <span class="math inline">\(n(a,t)\)</span> ~ <span class="math inline">\(B(N,P(a,t))\)</span>.</p>
<p>For the force-of-infection (FoI) that is constant over time, denoted
<span class="math inline">\(\lambda\)</span>, we modelled seroprevalence
for age <span class="math inline">\(a\)</span> in year <span class="math inline">\(t\)</span> (i.e.¬†the time when the serosurvey
occurred) as:</p>
<p><span class="math display">\[ P(a,t) =
1‚àíexp(‚àí\lambda{a})\]</span></p>
<p>The corresponding code for the constant-FoI model with binomial
distribution is:</p>
</div>
<div class="section level3">
<h3 id="time-varying-force-of-infection">Time-varying Force-of-Infection<a class="anchor" aria-label="anchor" href="#time-varying-force-of-infection"></a>
</h3>
<p>For the time-varying FoI model, the FoI values are estimated from a
binomial distribution. The sero-prevalence as age a can be expressed
as:</p>
<p><span class="math display">\[
ùëÉ(ùëé,ùë°)=1‚àíexp(‚àí‚àë_{i=t-a+1}^{t}ùúÜ{i})
\]</span></p>
<p>Therefore, a serosurvey completed at time <span class="math inline">\(t\)</span> and including ages <span class="math inline">\(a\)</span> from {<span class="math inline">\(age_{min}, age_{max}\)</span>} is informative on
exposure (and FoI) between {<span class="math inline">\(t,
age_{max}\)</span>} and <span class="math inline">\(t\)</span>.</p>
<p>Currently, two models within <em>serofoi</em> allow time-varying FoI,
with corresponding code:</p>
</div>
<div class="section level3">
<h3 id="fitting-process">Fitting process<a class="anchor" aria-label="anchor" href="#fitting-process"></a>
</h3>
<p>Models are implemented in <strong>RStan</strong> using the No-U-Turn
sampler, a type of Hamiltonian Monte Carlo sampling. After convergence,
the best-fitting models can be selected based on the expected log
predictive density for an out-of-sample data point (elpd).</p>
</div>
<div class="section level3">
<h3 id="case-study-1--chagas-disease-endemic-disease">Case study 1. Chagas disease (endemic disease)<a class="anchor" aria-label="anchor" href="#case-study-1--chagas-disease-endemic-disease"></a>
</h3>
<p>Based on the data and analysis shown in <span class="citation">(<a href="#ref-Cucunub%C3%A12017" role="doc-biblioref">Cucunub√° et al.
2017</a>)</span>, we use one of the datasets for measuring the
sero-prevalence of IgG antibodies against <em>Trypanosoma cruzi</em>
infection in rural area of Colombia in 2012. The dataset is part of the
serofoi package as <code>chagas2012</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"chagas2012"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chagas2012</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;       survey total counts age_min age_max year_init year_end tsur country  test</span></span>
<span><span class="co">#&gt; 1 COL-035-93    34      0       1       1      2012     2012 2012     COL ELISA</span></span>
<span><span class="co">#&gt; 2 COL-035-93    25      0       2       2      2012     2012 2012     COL ELISA</span></span>
<span><span class="co">#&gt; 3 COL-035-93    35      1       3       3      2012     2012 2012     COL ELISA</span></span>
<span><span class="co">#&gt; 4 COL-035-93    29      0       4       4      2012     2012 2012     COL ELISA</span></span>
<span><span class="co">#&gt; 5 COL-035-93    36      0       5       5      2012     2012 2012     COL ELISA</span></span>
<span><span class="co">#&gt;           antibody</span></span>
<span><span class="co">#&gt; 1 IgG anti-T.cruzi</span></span>
<span><span class="co">#&gt; 2 IgG anti-T.cruzi</span></span>
<span><span class="co">#&gt; 3 IgG anti-T.cruzi</span></span>
<span><span class="co">#&gt; 4 IgG anti-T.cruzi</span></span>
<span><span class="co">#&gt; 5 IgG anti-T.cruzi</span></span></code></pre></div>
<p>After preparing the data we can run two models (constant and time
varying) available on serofoi.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">chagas2012p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_serodata.html">prepare_serodata</a></span><span class="op">(</span><span class="va">chagas2012</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1_cha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chagas2012p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"constant_foi_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model constant_foi_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]              </span></span>
<span><span class="co">#&gt; seromodel_name "constant_foi_bi" </span></span>
<span><span class="co">#&gt; dataset        "COL-035-93"      </span></span>
<span><span class="co">#&gt; country        "COL"             </span></span>
<span><span class="co">#&gt; year           "2012"            </span></span>
<span><span class="co">#&gt; test           "ELISA"           </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-T.cruzi"</span></span>
<span><span class="co">#&gt; n_sample       "747"             </span></span>
<span><span class="co">#&gt; n_agec         "72"              </span></span>
<span><span class="co">#&gt; n_iter         "500"             </span></span>
<span><span class="co">#&gt; elpd           "-92.66"          </span></span>
<span><span class="co">#&gt; se             "6.54"            </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span>
<span></span>
<span><span class="va">m2_cha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chagas2012p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"continuous_foi_normal_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">1500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model continuous_foi_normal_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]                      </span></span>
<span><span class="co">#&gt; seromodel_name "continuous_foi_normal_bi"</span></span>
<span><span class="co">#&gt; dataset        "COL-035-93"              </span></span>
<span><span class="co">#&gt; country        "COL"                     </span></span>
<span><span class="co">#&gt; year           "2012"                    </span></span>
<span><span class="co">#&gt; test           "ELISA"                   </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-T.cruzi"        </span></span>
<span><span class="co">#&gt; n_sample       "747"                     </span></span>
<span><span class="co">#&gt; n_agec         "72"                      </span></span>
<span><span class="co">#&gt; n_iter         "1500"                    </span></span>
<span><span class="co">#&gt; elpd           "-74.7"                   </span></span>
<span><span class="co">#&gt; se             "5.83"                    </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span></code></pre></div>
<p>Now, we can plot the results of the two models to compare (Figure 1).
As shown in <span class="citation">Cucunub√° et al. (<a href="#ref-Cucunub%C3%A12017" role="doc-biblioref">2017</a>)</span>,
interventions for Chagas control have been ongoing from the 1980s in
Colombia having heterogeneous impact depending on the type of
population. For this serosurvey, which is from tradittional indigenous
rural area, the serofoi models are able to detect a modest still
relevant slow decreasing trend consistent (model 2) as slightly better
supported than the constant model. Notice that model 3 does not converge
despite a high number of iterations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1_cha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">m1_cha</span>, size_text <span class="op">=</span> <span class="fl">12</span>, max_lambda <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">p2_cha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">m2_cha</span>, size_text <span class="op">=</span> <span class="fl">12</span>, max_lambda <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1_cha</span>, <span class="va">p2_cha</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_cases_files/figure-html/model_comp_cha-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="case-study-2--hidden-alphaviruses-epidemics-in-panama">Case study 2. Hidden Alphaviruses epidemics in Panama<a class="anchor" aria-label="anchor" href="#case-study-2--hidden-alphaviruses-epidemics-in-panama"></a>
</h3>
<p>As shown in <span class="citation">(<a href="#ref-Carrera2020" role="doc-biblioref">Carrera et al. 2020</a>)</span>, hidden epidemic
and endemic transmission of alphaviruses in Eastern Panama have been
around for decades. From this paper we use a dataset measuring IgG
antibodies againts Venezuelan Equine Encephalitis Virus (VEEV) in a
rural village in Panam√° in 2017. This dataset, <code>veev2017</code> is
included in serofoi.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"veev2012"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">veev2012</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;          survey total counts age_min age_max year_init year_end tsur country</span></span>
<span><span class="co">#&gt; 1 PAN-2012-VEEV     6      3       1       5      2012     2012 2012     PAN</span></span>
<span><span class="co">#&gt; 2 PAN-2012-VEEV    14     11       5      10      2012     2012 2012     PAN</span></span>
<span><span class="co">#&gt; 3 PAN-2012-VEEV    14     11      10      15      2012     2012 2012     PAN</span></span>
<span><span class="co">#&gt; 4 PAN-2012-VEEV     8      5      15      20      2012     2012 2012     PAN</span></span>
<span><span class="co">#&gt; 5 PAN-2012-VEEV     8      7      20      25      2012     2012 2012     PAN</span></span>
<span><span class="co">#&gt;    test      antibody</span></span>
<span><span class="co">#&gt; 1 ELISA IgG anti-VEEV</span></span>
<span><span class="co">#&gt; 2 ELISA IgG anti-VEEV</span></span>
<span><span class="co">#&gt; 3 ELISA IgG anti-VEEV</span></span>
<span><span class="co">#&gt; 4 ELISA IgG anti-VEEV</span></span>
<span><span class="co">#&gt; 5 ELISA IgG anti-VEEV</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">veev2012p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_serodata.html">prepare_serodata</a></span><span class="op">(</span><span class="va">veev2012</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m1_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">veev2012p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"constant_foi_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model constant_foi_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]             </span></span>
<span><span class="co">#&gt; seromodel_name "constant_foi_bi"</span></span>
<span><span class="co">#&gt; dataset        "PAN-2012-VEEV"  </span></span>
<span><span class="co">#&gt; country        "PAN"            </span></span>
<span><span class="co">#&gt; year           "2012"           </span></span>
<span><span class="co">#&gt; test           "ELISA"          </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-VEEV"  </span></span>
<span><span class="co">#&gt; n_sample       "146"            </span></span>
<span><span class="co">#&gt; n_agec         "17"             </span></span>
<span><span class="co">#&gt; n_iter         "500"            </span></span>
<span><span class="co">#&gt; elpd           "-43.81"         </span></span>
<span><span class="co">#&gt; se             "13.9"           </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span>
<span></span>
<span><span class="va">m2_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">veev2012p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"continuous_foi_normal_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model continuous_foi_normal_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]                      </span></span>
<span><span class="co">#&gt; seromodel_name "continuous_foi_normal_bi"</span></span>
<span><span class="co">#&gt; dataset        "PAN-2012-VEEV"           </span></span>
<span><span class="co">#&gt; country        "PAN"                     </span></span>
<span><span class="co">#&gt; year           "2012"                    </span></span>
<span><span class="co">#&gt; test           "ELISA"                   </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-VEEV"           </span></span>
<span><span class="co">#&gt; n_sample       "146"                     </span></span>
<span><span class="co">#&gt; n_agec         "17"                      </span></span>
<span><span class="co">#&gt; n_iter         "500"                     </span></span>
<span><span class="co">#&gt; elpd           "-28.74"                  </span></span>
<span><span class="co">#&gt; se             "7.04"                    </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span>
<span></span>
<span><span class="va">m3_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">veev2012p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"continuous_foi_normal_log"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model continuous_foi_normal_log finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]                       </span></span>
<span><span class="co">#&gt; seromodel_name "continuous_foi_normal_log"</span></span>
<span><span class="co">#&gt; dataset        "PAN-2012-VEEV"            </span></span>
<span><span class="co">#&gt; country        "PAN"                      </span></span>
<span><span class="co">#&gt; year           "2012"                     </span></span>
<span><span class="co">#&gt; test           "ELISA"                    </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-VEEV"            </span></span>
<span><span class="co">#&gt; n_sample       "146"                      </span></span>
<span><span class="co">#&gt; n_agec         "17"                       </span></span>
<span><span class="co">#&gt; n_iter         "500"                      </span></span>
<span><span class="co">#&gt; elpd           "-22"                      </span></span>
<span><span class="co">#&gt; se             "2.99"                     </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span></code></pre></div>
<p>Now, we can plot the results of the three models to compare. On
Figure 3, we can observe a large increase in the estimated FOI. As
suggested in <span class="citation">Carrera et al. (<a href="#ref-Carrera2020" role="doc-biblioref">2020</a>)</span>, an
important increase in the transmission of VEEV in this region is
inferred. Although the three fitted models converge well, we see much
larger support for a more sudden increase in recent years with highest
FoI values at 0.25 (consistent with an epidemic).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">m1_veev</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">p2_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">m2_veev</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">p3_veev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">m3_veev</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1_veev</span>, <span class="va">p2_veev</span>, <span class="va">p3_veev</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_cases_files/figure-html/model_comp_veev-1.png" width="960"></p>
<p>Figure 3. Results of fitted models, Force-of-Infection estimates and
convergence.</p>
</div>
<div class="section level3">
<h3 id="case-study-3--a-known-large-chikungunya-epidemic-in-brazil">Case study 3. A known Large Chikungunya epidemic in Brazil<a class="anchor" aria-label="anchor" href="#case-study-3--a-known-large-chikungunya-epidemic-in-brazil"></a>
</h3>
<p>Chikungunya outbreaks ocurred rapidly after the introduction of the
virus to Brazil in 2013-2014. We use the dataset from <span class="citation">(<a href="#ref-dias2018" role="doc-biblioref">Dias et
al. 2018</a>)</span> that conducts a population-based study through
household interviews and serologic surveys (measuring IgG antibodies
against Chikungunya virus) in Bahia, Brazil during October-December
2015, right after a large CHIKV epidemic that occurred in that area.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"chik2015"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chik2015</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;           survey total counts age_min age_max year_init year_end tsur country</span></span>
<span><span class="co">#&gt; 1 BRA 2015(S019)   144     63      40      59      2015     2015 2015     BRA</span></span>
<span><span class="co">#&gt; 2 BRA 2015(S019)   148     69      60      79      2015     2015 2015     BRA</span></span>
<span><span class="co">#&gt; 3 BRA 2015(S019)    45     17       1      19      2015     2015 2015     BRA</span></span>
<span><span class="co">#&gt; 4 BRA 2015(S019)   109     55      20      39      2015     2015 2015     BRA</span></span>
<span><span class="co">#&gt;    test       antibody        reference</span></span>
<span><span class="co">#&gt; 1 ELISA IgG anti-CHIKV Dias et al. 2018</span></span>
<span><span class="co">#&gt; 2 ELISA IgG anti-CHIKV Dias et al. 2018</span></span>
<span><span class="co">#&gt; 3 ELISA IgG anti-CHIKV Dias et al. 2018</span></span>
<span><span class="co">#&gt; 4 ELISA IgG anti-CHIKV Dias et al. 2018</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">chik2015p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_serodata.html">prepare_serodata</a></span><span class="op">(</span><span class="va">chik2015</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod1_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chik2015p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"constant_foi_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model constant_foi_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]             </span></span>
<span><span class="co">#&gt; seromodel_name "constant_foi_bi"</span></span>
<span><span class="co">#&gt; dataset        "BRA 2015(S019)" </span></span>
<span><span class="co">#&gt; country        "BRA"            </span></span>
<span><span class="co">#&gt; year           "2015"           </span></span>
<span><span class="co">#&gt; test           "ELISA"          </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-CHIKV" </span></span>
<span><span class="co">#&gt; n_sample       "446"            </span></span>
<span><span class="co">#&gt; n_agec         "4"              </span></span>
<span><span class="co">#&gt; n_iter         "1000"           </span></span>
<span><span class="co">#&gt; elpd           "-39.57"         </span></span>
<span><span class="co">#&gt; se             "8.48"           </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span>
<span></span>
<span><span class="va">mod2_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chik2015p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"continuous_foi_normal_bi"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">1500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model continuous_foi_normal_bi finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]                      </span></span>
<span><span class="co">#&gt; seromodel_name "continuous_foi_normal_bi"</span></span>
<span><span class="co">#&gt; dataset        "BRA 2015(S019)"          </span></span>
<span><span class="co">#&gt; country        "BRA"                     </span></span>
<span><span class="co">#&gt; year           "2015"                    </span></span>
<span><span class="co">#&gt; test           "ELISA"                   </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-CHIKV"          </span></span>
<span><span class="co">#&gt; n_sample       "446"                     </span></span>
<span><span class="co">#&gt; n_agec         "4"                       </span></span>
<span><span class="co">#&gt; n_iter         "1500"                    </span></span>
<span><span class="co">#&gt; elpd           "-20.76"                  </span></span>
<span><span class="co">#&gt; se             "1.98"                    </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span>
<span></span>
<span><span class="va">mod3_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_seromodel.html">run_seromodel</a></span><span class="op">(</span>serodata <span class="op">=</span> <span class="va">chik2015p</span>,</span>
<span>                     seromodel_name <span class="op">=</span> <span class="st">"continuous_foi_normal_log"</span>,</span>
<span>                     n_iters <span class="op">=</span> <span class="fl">1500</span>, </span>
<span>                     n_thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "serofoi model continuous_foi_normal_log finished running ------"</span></span>
<span><span class="co">#&gt;                [,1]                       </span></span>
<span><span class="co">#&gt; seromodel_name "continuous_foi_normal_log"</span></span>
<span><span class="co">#&gt; dataset        "BRA 2015(S019)"           </span></span>
<span><span class="co">#&gt; country        "BRA"                      </span></span>
<span><span class="co">#&gt; year           "2015"                     </span></span>
<span><span class="co">#&gt; test           "ELISA"                    </span></span>
<span><span class="co">#&gt; antibody       "IgG anti-CHIKV"           </span></span>
<span><span class="co">#&gt; n_sample       "446"                      </span></span>
<span><span class="co">#&gt; n_agec         "4"                        </span></span>
<span><span class="co">#&gt; n_iter         "1500"                     </span></span>
<span><span class="co">#&gt; elpd           "-12.58"                   </span></span>
<span><span class="co">#&gt; se             "0.81"                     </span></span>
<span><span class="co">#&gt; converged      "Yes"</span></span></code></pre></div>
<p>In Figure 4, we can observe the comparison between the three serofoi
models. Here serofoi shows strong statistical support for a sudden
increase in the transmission of CHIKV close to the year of the
serosurvey (2015). The exact year is not possible to estimate, mainly
given the data used is largely aggregated by 20-years age groups.
Despite that, the results are consistent with the empirical evidence
shown by <span class="citation">(<a href="#ref-dias2018" role="doc-biblioref">Dias et al. 2018</a>)</span> with both interviews,
and IgM testing.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">mod1_chik</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span>
<span><span class="va">p2_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">mod2_chik</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span>
<span><span class="va">p3_chik</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_seromodel.html">plot_seromodel</a></span><span class="op">(</span><span class="va">mod3_chik</span>, size_text <span class="op">=</span> <span class="fl">10</span>, max_lambda <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1_chik</span>, <span class="va">p2_chik</span>, <span class="va">p3_chik</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_cases_files/figure-html/plot_chik-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Carrera2020" class="csl-entry">
Carrera, Jean-Paul, Zulma M. Cucunub√°, Karen Neira, Ben Lambert, Yaneth
Pitt√≠, Jesus Liscano, Jorge L. Garz√≥n, et al. 2020. <span>‚ÄúEndemic and
Epidemic Human Alphavirus Infections in Eastern Panama: An Analysis of
Population-Based Cross-Sectional Surveys.‚Äù</span> <em>The American
Journal of Tropical Medicine and Hygiene</em> 103 (6): 2429‚Äì37. <a href="https://doi.org/10.4269/ajtmh.20-0408" class="external-link">https://doi.org/10.4269/ajtmh.20-0408</a>.
</div>
<div id="ref-Cucunub√°2017" class="csl-entry">
Cucunub√°, Zulma M, Pierre Nouvellet, Lesong Conteh, Mauricio Javier
Vera, Victor Manuel Angulo, Juan Carlos Dib, Gabriel Jaime Parra -Henao,
and Mar√≠a Gloria Bas√°√±ez. 2017. <span>‚ÄúModelling Historical Changes in
the Force-of-Infection of Chagas Disease to Inform Control and
Elimination Programmes: Application in Colombia.‚Äù</span> <em>BMJ Global
Health</em> 2 (3): e000345. <a href="https://doi.org/10.1136/bmjgh-2017-000345" class="external-link">https://doi.org/10.1136/bmjgh-2017-000345</a>.
</div>
<div id="ref-dias2018" class="csl-entry">
Dias, Juarez P., Maria da Concei√ß√£o N. Costa, Gubio Soares Campos, Enny
S. Paix√£o, Marcio S. Natividade, Florisneide R. Barreto, Martha Suely C.
Itaparica, et al. 2018. <span>‚ÄúSeroprevalence of Chikungunya Virus After
Its Emergence in Brazil.‚Äù</span> <em>Emerging Infectious Diseases</em>
24 (4): 617‚Äì24. <a href="https://doi.org/10.3201/eid2404.171370" class="external-link">https://doi.org/10.3201/eid2404.171370</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zulma M. Cucunub√°, Nicol√°s Torres, Ben Lambert, Pierre Nouvellet.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
